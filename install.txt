https://github.com/openai/mujoco-py


Requirements
	conda create -n robo python=3.7 # 3.8 not work for pygame
	conda install pip
	sudo apt install libosmesa6-dev libgl1-mesa-glx libglfw3
	conda install patchelf
	# sudo apt install libfreetype6-dev libsdl1.2-dev # for surreal (failed because python 3.8 for pygame)
	conda install cffi # on proj66
	# sudo yum install mesa* # on gpu servers


Install MuJoCo
	License
		export MUJOCO_PY_MJKEY_PATH=/uac/gds/jqxu/.mujoco/keys/gpu*/mjkey.txt
	Download
		# from surreal github: https://github.com/SurrealAI/surreal/blob/master/docker/Dockerfile-ubuntu
		# wget https://www.roboti.us/download/mjpro150_linux.zip
		install mujoco 2.0
		https://github.com/openai/mujoco-py
		wget https://www.roboti.us/download/mujoco200_linux.zip
	Unzip
	~/.bashrc
		# export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/home/jqxu/.mujoco/mjpro150/bin
	# pip install mujoco-py==1.50.1.68 (2.0.2.9 is incompatible with surreal)
	pip install mujoco-py (==2.0.2.9)
		https://pypi.org/project/mujoco-py/


Install Surreal
	pip install pygame (1.9.6 in this case for python 3.7)
	conda install pytorch=1.4.0 torchvision cudatoolkit=10.1 -c pytorch # still cannot fully solve
		# pytorch 1.5.0 will give warning
		# set CUDA to 10.1 in .bashrc because when CUDA 10.2
		# "File "/research/dept6/jqxu/anaconda3/envs/surreal/lib/python3.7/site-packages/torch/nn/modules/rnn.py", line 129, in flatten_parameters \
    		# self.batch_first, bool(self.bidirectional)) \
		# RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED"
		Sometimes may be due to CUDA out of memory
		check nvidia-smi to leave some space # 32 -> 30 agents on 12GB gpu

	pip install tensorflow=2.0.0 # not tensorflow-gpu
		# if tensorflow >= 2.1.0 (I guess, cannot remember)
                # Could not load dynamic library 'libnvinfer_plugin.so.6';
		# Cannot dlopen some TensorRT libraries.
		# https://github.com/tensorflow/tensorflow/issues/35968

	# pip install robosuite==0.2.0
		https://github.com/StanfordVL/robosuite
		https://github.com/StanfordVL/robosuite/releases
		wget https://github.com/StanfordVL/robosuite/archive/v0.2.0.zip 
	# git clone robosuite=0.2.0
		pip install -e .
			# also change .values to [()] in demo_wrapper
	git clone my/robosuite(modified on 0.3.0)
		git checkout -b dev origin/dev
		pip install -e .

	git clone my/symphony
		git checkout -b dev origin/dev
		pip install -e .
			# CUDA_VISIBLE_DEVICES bug

	# pip install surreal
		# for mujocoo-py==1.50.1.68
		ERROR: robosuite 0.3.0 has requirement mujoco-py==2.0.2.2, but you'll have mujoco-py 1.50.1.68 which is incompatible.
		# OR for mujocoo-py==2.0.2.2
		ERROR: surreal 0.2.1 requires robosuite, which is not installed.
	git clone my/surreal
		# several modify
		compatible with the current robosuite
		git checkout -b dev origin/dev
		pip install -e .

	sudo apt install libglew-dev
	# export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libGLEW.so # for rendering

#ISSUE
When using camera obs: 
	has_offscreen_renderer=True

ERROR: GLEW initalization error: Missing GL Version
	https://github.com/openai/mujoco-py/issues/408
	TO FIX: # fixed on my local pc
		sudo mkdir -p /usr/lib/nvidia-440
		LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/lib/nvidia-440

THEN error: conflicting types for ‘PFNGLFRAGMENTLIGHTFVSGIXPROC’
	https://github.com/openai/mujoco-py/issues/383
	TO FIX:
		as in 383
		locate eglshim.c
		//#include <GL/glewt.h>

headless error: 
	RuntimeError: Failed to initialize OpenGL
	Found 8 GPUs for rendering. Using device 1.
	Could not initialize EGL
	TO FIX:
		https://github.com/openai/mujoco-py/issues/512
		https://github.com/openai/mujoco-py/issues/187
		https://github.com/deepmind/dm_control/issues/123
		https://askubuntu.com/questions/244133/how-do-i-get-egl-and-opengles-libraries-for-ubuntu-running-on-virtualbox
	Can spread GPUs by my/surreal/dev
	still cannot initialize on other gpus
